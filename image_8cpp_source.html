<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>LSBPT: image.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LSBPT
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">image.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="image_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// (at your option) any later version.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// GNU General Public License for more details.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="image_8h.html">image.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;QMessageBox&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="compoundmodel_8h.html">compoundmodel.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="classimage.html#a4689c56b85c46d48ea52f0c9fa13891e">   21</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#a4689c56b85c46d48ea52f0c9fa13891e">image::processing</a>()</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    this-&gt;<a class="code" href="classimage.html#ad5a9d767eca6f9bbb8dcb556527edf4d">ProcessTiles</a>();</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    this-&gt;<a class="code" href="classimage.html#a83026280ad6cc713ec9489ff3bd9776e">ProcessBoundaryX</a>();</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    this-&gt;<a class="code" href="classimage.html#adf6b8c126649c9a40387f12b5f5f07d5">ProcessBoundaryY</a>();</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classimage.html#ad5a9d767eca6f9bbb8dcb556527edf4d">   40</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#ad5a9d767eca6f9bbb8dcb556527edf4d">image::ProcessTiles</a>()</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i =0; i&lt; this-&gt;nBlocksX; i++){</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j =0; j&lt; this-&gt;nBlocksY; j++){</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#pragma omp critical</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                <span class="comment">//print some basic info to log file</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                this-&gt;<a class="code" href="classimage.html#ad8f92b1e7e0d07c12286ca2cd7163472">PrintTileInfo</a>(i,j);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <a class="code" href="classimageblock.html">imageblock</a> temp;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            temp.<a class="code" href="classimageblock.html#aa28c36c8019b54006331c050484d0701">setParameters</a>( i, j, this-&gt;data,</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                this-&gt;blockSizeW[i], this-&gt;blockSizeH[j],</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                this-&gt;blocksStartPointX[i], this-&gt;blocksStartPointY[j],</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                this-&gt;imageWidth, this-&gt;imageHeight,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                this-&gt;startPointX, this-&gt;startPointY,</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                this-&gt;imageFormat,</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                this-&gt;ifDeleteNoise, this-&gt;orderMin, this-&gt;orderMax,</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                this-&gt;ifAddProbabilityModel,</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                this-&gt;nClasses, this-&gt;nbins,</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                this-&gt;useStdCut,</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a>,</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                this-&gt;<a class="code" href="classimage.html#aaad80e489cb7ecf01f2706a3a18ac816">directoryProbabilities</a>,</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                this-&gt;ifPaintRandomColor,</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                this-&gt;lamda);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            temp.<a class="code" href="classimageblock.html#af3b91e3daaa8014af1239f60da6b0bf5">processing</a>();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//wait all thread arrives</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#pragma omp barrier</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classimage.html#a83026280ad6cc713ec9489ff3bd9776e">   88</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#a83026280ad6cc713ec9489ff3bd9776e">image::ProcessBoundaryX</a>()</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">int</span> circle = this-&gt;<a class="code" href="classimage.html#a05e6294bd8fc01bac57478de38e5a92d">ComputeCircle</a> ( this-&gt;nBlocksX - 1 );</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> index=1; index &lt; circle +1; index++){</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;working on circle &quot;</span> &lt;&lt; index &lt;&lt; endl;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordtype">int</span> step = pow(2,index);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">        #pragma omp parallel for schedule(runtime)</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = pow(2,index-1); i &lt; this-&gt;nBlocksX;  i += step){</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">            #pragma omp parallel for schedule(dynamic)</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j=0; j &lt; this-&gt;nBlocksY; j++ ) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                std::vector&lt;WorkingBoundary&gt; workingBoundaries;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <a class="code" href="class_working_boundary.html">WorkingBoundary</a> tempBoundary1(1, this-&gt;blocksStartPointX[i]-1 ,</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                              this-&gt;blocksStartPointY[j],</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                              this-&gt;blocksStartPointY[j]+this-&gt;blockSizeH[j]-1);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <a class="code" href="class_working_boundary.html">WorkingBoundary</a> tempBoundary2(1, this-&gt;blocksStartPointX[i],</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                              this-&gt;blocksStartPointY[j],</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                              this-&gt;blocksStartPointY[j]+this-&gt;blockSizeH[j]-1);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                workingBoundaries.push_back(tempBoundary1);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                workingBoundaries.push_back(tempBoundary2);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                std::vector&lt;int&gt; blockPosition1, blockPosition2;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                blockPosition1.push_back(i-1);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                blockPosition1.push_back(j);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                blockPosition2.push_back(i);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                blockPosition2.push_back(j);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                this-&gt;<a class="code" href="classimage.html#a12343719e8d96a4bda9c5bd6c035d52a">mergeBlockX</a>( workingBoundaries, blockPosition1, blockPosition2 );</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">        #pragma omp barrier</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="classimage.html#adf6b8c126649c9a40387f12b5f5f07d5">  139</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#adf6b8c126649c9a40387f12b5f5f07d5">image::ProcessBoundaryY</a>()</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">int</span> circle = this-&gt;<a class="code" href="classimage.html#a05e6294bd8fc01bac57478de38e5a92d">ComputeCircle</a> ( this-&gt;nBlocksY - 1);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> index=1; index &lt; circle +1; index++){</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;working on circle &quot;</span> &lt;&lt; index &lt;&lt; endl;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordtype">int</span> step = pow(2,index);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j = pow(2,index-1); j &lt; this-&gt;nBlocksY;  j += step){</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i &lt; this-&gt;nBlocksX; i++ ) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                std::vector&lt;WorkingBoundary&gt; workingBoundaries ;<span class="comment">// a function to find the working boundaries smartly</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <a class="code" href="class_working_boundary.html">WorkingBoundary</a> tempBoundary1(0, this-&gt;blocksStartPointY[j]-1 , this-&gt;blocksStartPointX[i],</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                              this-&gt;blocksStartPointX[i]+this-&gt;blockSizeW[i]-1);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <a class="code" href="class_working_boundary.html">WorkingBoundary</a> tempBoundary2(0, this-&gt;blocksStartPointY[j]   , this-&gt;blocksStartPointX[i],</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                              this-&gt;blocksStartPointX[i]+this-&gt;blockSizeW[i]-1);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                workingBoundaries.push_back(tempBoundary1);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                workingBoundaries.push_back(tempBoundary2);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                std::vector&lt;int&gt; blockPosition1, blockPosition2;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                blockPosition1.push_back(i);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                blockPosition1.push_back(j-1);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                blockPosition2.push_back(i);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                blockPosition2.push_back(j);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                this-&gt;<a class="code" href="classimage.html#aa21fc5a07af7528869425e750090b3b8">mergeBlockY</a>( workingBoundaries, blockPosition1, blockPosition2 );</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#pragma omp barrier</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="classimage.html#a8a46cfc72e8bbc9b85c431e9a4f6d755">  184</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#a8a46cfc72e8bbc9b85c431e9a4f6d755">image::findImageFormat</a>()</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;{</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">switch</span> ( this-&gt;data-&gt;GetRasterBand(1)-&gt;GetRasterDataType()) {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">case</span> GDT_Byte : {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        this-&gt;imageFormat = <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaafad84bb170ef6e1eaf6db062c95d4d29">U8I</a>; <span class="comment">// unsigned 8 byte integer</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }<span class="keywordflow">break</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">case</span> GDT_UInt16 : {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        this-&gt;imageFormat = <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaad5d8b5731dfb8fa24e8523b2ebffdf7f">U16I</a>; <span class="comment">// unsigned 16 byte interger</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }<span class="keywordflow">break</span>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">case</span> GDT_Int16 : {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        this-&gt;imageFormat = <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa181e4b80585669687eae4cb4a527397e">S16I</a>; <span class="comment">// signed 16 byte interger</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }<span class="keywordflow">break</span>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">case</span> GDT_UInt32 :{</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        this-&gt;imageFormat = <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa234e6937916f66a485971765c6bb5a8b">U32I</a>; <span class="comment">// unsigned 32 byte integer</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }<span class="keywordflow">break</span>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">case</span> GDT_Int32 : {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        this-&gt;imageFormat = <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaadf7d8480a3f600d86f4285decd4cad8d">S32I</a>; <span class="comment">// signed 32  byte interger</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }<span class="keywordflow">break</span>;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">case</span> GDT_Float32 : {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        this-&gt;imageFormat = <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa90ded373041ca522cbec296a8d0f31d9">F32</a>; <span class="comment">// float</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }<span class="keywordflow">break</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">case</span> GDT_Float64 :{</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        this-&gt;imageFormat = <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa3943835df9d39a82c801bc9c7081869b">F64</a>; <span class="comment">// double</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }<span class="keywordflow">break</span>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">default</span>: exit(1);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classimage.html#ad86284aa4e8e75cfc904084479146f2f">  222</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#ad86284aa4e8e75cfc904084479146f2f">image::linkFile</a>()</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    GDALAllRegister();</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    this-&gt;data =  (GDALDataset *) GDALOpen( this-&gt;<a class="code" href="classimage.html#a2de1707f5743afdd5c9684aa7a071b3f">fileNameImage</a>.c_str(), GA_ReadOnly );</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span>( this-&gt;data== NULL ) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        QMessageBox::critical(NULL,<span class="stringliteral">&quot;Error!&quot;</span>, <span class="stringliteral">&quot;Open image with GDAL failed!&quot;</span>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        this-&gt;<a class="code" href="classimage.html#a8a46cfc72e8bbc9b85c431e9a4f6d755">findImageFormat</a>();</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        std::cout&lt;&lt;<span class="stringliteral">&quot;Image linked&quot;</span> &lt;&lt;endl;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    GetGDALDriverManager()-&gt;AutoSkipDrivers();</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="classimage.html#ad8f92b1e7e0d07c12286ca2cd7163472">  244</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#ad8f92b1e7e0d07c12286ca2cd7163472">image::PrintTileInfo</a>(<span class="keywordtype">int</span> indexX, <span class="keywordtype">int</span> indexY)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;{</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    FILE * logFile = fopen( this-&gt;logFileName.c_str(), <span class="stringliteral">&quot;a&quot;</span> );</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    fprintf( logFile, <span class="stringliteral">&quot;Processing tile ( %d , %d ), the tile start point is ( %d ,%d ), tiles size is ( %d , %d )\n&quot;</span>,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            indexX, indexY, this-&gt;blocksStartPointX[indexX], this-&gt;blocksStartPointY[indexY],</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            this-&gt;blockSizeW[indexX], this-&gt;blockSizeH[indexY]);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    fclose(logFile);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="classimage.html#a05e6294bd8fc01bac57478de38e5a92d">  264</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classimage.html#a05e6294bd8fc01bac57478de38e5a92d">image::ComputeCircle</a>( <span class="keywordtype">int</span> totalTiles )</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordtype">int</span> counter = totalTiles;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;     <span class="keywordtype">int</span> circle = 0;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     <span class="keywordflow">while</span>( counter &gt;= 1){</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;         counter /= 2;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         circle++;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;     }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;     <span class="keywordflow">return</span> circle;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;}</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="classimage.html#a12343719e8d96a4bda9c5bd6c035d52a">  285</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#a12343719e8d96a4bda9c5bd6c035d52a">image::mergeBlockX</a>(<span class="keyword">const</span> std::vector&lt; WorkingBoundary &gt; &amp;workingBoundaries,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                        <span class="keyword">const</span> std::vector&lt;int&gt; &amp;blockPosition1,</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                        <span class="keyword">const</span> std::vector&lt;int&gt; &amp;blockPosition2)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;{</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">//read segments from temperary file</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    std::vector&lt;Node *&gt; selectedBoarderNodes;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    std::string fileName1 = <span class="stringliteral">&quot;i&quot;</span> + std::to_string( blockPosition1[0] ) + <span class="stringliteral">&quot;j&quot;</span> + std::to_string(blockPosition1[1]);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    std::string fileName2 = <span class="stringliteral">&quot;i&quot;</span> + std::to_string( blockPosition2[0] ) + <span class="stringliteral">&quot;j&quot;</span> + std::to_string(blockPosition2[1]);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    this-&gt;<a class="code" href="classimage.html#a7934adc398c4b1c001fe38b0500e8341">selectBoarderSegments</a>( &amp;selectedBoarderNodes,  workingBoundaries, fileName1.c_str());</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    this-&gt;<a class="code" href="classimage.html#a7934adc398c4b1c001fe38b0500e8341">selectBoarderSegments</a>( &amp;selectedBoarderNodes,  workingBoundaries, fileName2.c_str());</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span>( selectedBoarderNodes.size() ==0 ) {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        qDebug() &lt;&lt; <span class="stringliteral">&quot;There is something wrong in selectBoarderNodes.&quot;</span>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="class_r_a_g.html">RAG</a> ragBoarder;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="classinitializer.html#ae6d34d311f884ceb489b3043a011864c">initializer::initializeRag</a>(ragBoarder, selectedBoarderNodes);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="class_node.html">Node</a> *root;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    root = ragBoarder.<a class="code" href="class_r_a_g.html#ab09eebb1b704d18b583d528e77f7604a">regionMerging</a>();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">//  double cost=0;</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">//  std::vector&lt;Node *&gt; boarderSegmentationNodes;</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">//  this-&gt;bestSegmentation(root,boarderSegmentationNodes, cost);</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="preprocessor">#pragma omp critical</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="comment">//  saveToDisk(boarderSegmentationNodes, blockPosition1[1]);</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    std::vector&lt;Node*&gt; selectedSegmentationNodes;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    selectedSegmentationNodes.push_back(root);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; this-&gt;lamda.size(); i++){</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        std::vector&lt;Node*&gt; tempSelected;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j &lt; selectedSegmentationNodes.size(); j++){</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordtype">double</span> cost;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            std::vector&lt;Node*&gt; temp;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <a class="code" href="classio.html#a665eff0517fb9afbded1a2a7db62e1d7">io::bestSegmentation</a>(selectedSegmentationNodes[j], temp, cost, this-&gt;lamda[i], this-&gt;useStdCut);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            tempSelected.insert( tempSelected.begin(), temp.begin(), temp.end());</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        selectedSegmentationNodes.clear();</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        selectedSegmentationNodes = tempSelected;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        tempSelected.clear();</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor">#pragma omp critical</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <a class="code" href="classimage.html#a3a11f9e84755d71dd86e6161f633dd80">saveToDisk</a>(selectedSegmentationNodes, blockPosition1[1], i);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    root-&gt;<a class="code" href="class_node.html#adaaa531eae8cc809934f80b09ad8224e">releaseTree</a>();</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classimage.html#aa21fc5a07af7528869425e750090b3b8">  363</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#aa21fc5a07af7528869425e750090b3b8">image::mergeBlockY</a>(<span class="keyword">const</span> std::vector&lt; WorkingBoundary &gt; &amp;workingBoundaries,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                        <span class="keyword">const</span> std::vector&lt;int&gt; &amp;blockPosition1,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                        <span class="keyword">const</span> std::vector&lt;int&gt; &amp;blockPosition2)</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span>( workingBoundaries.size() == 0 ) { <span class="comment">// for the first block</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        qDebug() &lt;&lt; <span class="stringliteral">&quot;Working boundaries not set.&quot;</span> ;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    std::vector&lt;Node *&gt; selectedBoarderNodes;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    selectedBoarderNodes.clear();</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    std::string fileName1 = <span class="stringliteral">&quot;i&quot;</span> + std::to_string( blockPosition1[0] ) + <span class="stringliteral">&quot;j&quot;</span> + std::to_string(blockPosition1[1]);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    std::string fileName2 = <span class="stringliteral">&quot;i&quot;</span> + std::to_string( blockPosition2[0] ) + <span class="stringliteral">&quot;j&quot;</span> + std::to_string(blockPosition2[1]);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    std::string fileName3 = <span class="stringliteral">&quot;j&quot;</span> + std::to_string(blockPosition1[1]);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    std::string fileName4 = <span class="stringliteral">&quot;j&quot;</span> + std::to_string(blockPosition2[1]);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    this-&gt;<a class="code" href="classimage.html#a7934adc398c4b1c001fe38b0500e8341">selectBoarderSegments</a>( &amp;selectedBoarderNodes,  workingBoundaries, fileName1.c_str());</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    this-&gt;<a class="code" href="classimage.html#a7934adc398c4b1c001fe38b0500e8341">selectBoarderSegments</a>( &amp;selectedBoarderNodes,  workingBoundaries, fileName2.c_str());</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    this-&gt;<a class="code" href="classimage.html#a7934adc398c4b1c001fe38b0500e8341">selectBoarderSegments</a>( &amp;selectedBoarderNodes,  workingBoundaries, fileName3.c_str());</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    this-&gt;<a class="code" href="classimage.html#a7934adc398c4b1c001fe38b0500e8341">selectBoarderSegments</a>( &amp;selectedBoarderNodes,  workingBoundaries, fileName4.c_str());</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">if</span>( selectedBoarderNodes.size() ==0 ) {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        qDebug() &lt;&lt; <span class="stringliteral">&quot;There is something wrong in selectBoarderNodes.&quot;</span>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="comment">//exit(1);</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="class_r_a_g.html">RAG</a> ragBoarder;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="classinitializer.html#ae6d34d311f884ceb489b3043a011864c">initializer::initializeRag</a>( ragBoarder, selectedBoarderNodes);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="class_node.html">Node</a> *root;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    root = ragBoarder.<a class="code" href="class_r_a_g.html#ab09eebb1b704d18b583d528e77f7604a">regionMerging</a>();</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; <span class="comment">//   double cost=0;</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">//  std::vector&lt;Node *&gt; boarderSegmentationNodes;</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">//  boarderSegmentationNodes.clear();</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; <span class="comment">//   this-&gt;bestSegmentation(root,boarderSegmentationNodes, cost);</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">    #pragma omp critical</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="comment">// saveToDisk(boarderSegmentationNodes, workingBoundaries);</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    std::vector&lt;Node*&gt; selectedSegmentationNodes;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    selectedSegmentationNodes.push_back(root);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; this-&gt;lamda.size(); i++){</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        std::vector&lt;Node*&gt; tempSelected;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j &lt; selectedSegmentationNodes.size(); j++){</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordtype">double</span> cost;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            std::vector&lt;Node*&gt; temp;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <a class="code" href="classio.html#a665eff0517fb9afbded1a2a7db62e1d7">io::bestSegmentation</a>(selectedSegmentationNodes[j], temp, cost, this-&gt;lamda[i], this-&gt;useStdCut);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            tempSelected.insert( tempSelected.begin(), temp.begin(), temp.end());</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        selectedSegmentationNodes.clear();</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        selectedSegmentationNodes = tempSelected;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        tempSelected.clear();</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="preprocessor">#pragma omp critical</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <a class="code" href="classimage.html#a3a11f9e84755d71dd86e6161f633dd80">saveToDisk</a>(selectedSegmentationNodes, workingBoundaries, i);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    root-&gt;<a class="code" href="class_node.html#adaaa531eae8cc809934f80b09ad8224e">releaseTree</a>();</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="classimage.html#a7934adc398c4b1c001fe38b0500e8341">  453</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#a7934adc398c4b1c001fe38b0500e8341">image::selectBoarderSegments</a>( std::vector&lt;Node *&gt; *selected,  <span class="keyword">const</span> std::vector&lt; WorkingBoundary &gt; &amp; workingBoundaries, std::string boarderFileName)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;{ <span class="comment">//workingBoundaries &#39;s element looks like [ row/col, rowNumber/colNUmber, min, max], i.e, [0, 1000,2000, 4000] 0 represent row</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    ifstream fin;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    fin.open(boarderFileName.c_str(), ios::in);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (fin.fail()){</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        qDebug() &lt;&lt; <span class="stringliteral">&quot;There may have some problems in selectBoarderSegments !&quot;</span>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        fin.clear( );</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    std::string fileNameOut = boarderFileName + <span class="stringliteral">&quot;temp.csv&quot;</span>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    ofstream fout;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    fout.open( fileNameOut.c_str(),  ios::app );</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    std::vector&lt;size_t&gt; positionXSet;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    std::vector&lt;size_t&gt; positionYSet;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    std::vector&lt;int&gt; labelSet;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    std::vector&lt;size_t&gt; boarderIndexXSet;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    std::vector&lt;size_t&gt; boarderIndexYSet;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    std::vector&lt;std::vector&lt;float&gt; &gt; spectrumSet;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    std::vector&lt;std::vector&lt;double&gt; &gt; probabilitiesSet;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordtype">int</span> segmentSeperator = -1;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">bool</span> ifSelect = <span class="keyword">false</span>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    std::vector&lt;long int&gt; minX(workingBoundaries.size());</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    std::vector&lt;long int&gt; maxX(workingBoundaries.size());</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    std::vector&lt;long int&gt; minY(workingBoundaries.size());</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    std::vector&lt;long int&gt; maxY(workingBoundaries.size());</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i &lt; workingBoundaries.size(); i++) {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        minX[i] = LONG_MAX;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        minY[i] = LONG_MAX;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        maxX[i] = LONG_MIN;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        maxY[i] = LONG_MIN;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    std::string line;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">while</span> ( std::getline( fin, line ) ){</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        std::istringstream data( line );</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordtype">long</span> positionX;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordtype">long</span> positionY;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordtype">int</span> label;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordtype">size_t</span> boarderIndexX;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordtype">size_t</span> boarderIndexY;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        std::vector&lt;float&gt; spectrum;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        std::vector&lt;double&gt;probabilities;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">// read position and label</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        data &gt;&gt; positionX &gt;&gt; positionY &gt;&gt; label &gt;&gt; boarderIndexX &gt;&gt; boarderIndexY;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="comment">// read spectrum info</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt; this-&gt;nBands; i++)</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordtype">double</span> tempValue;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            data &gt;&gt; tempValue;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            spectrum.push_back( tempValue );</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel){</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="comment">//read probability info</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt; this-&gt;nClasses; i++)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                <span class="keywordtype">double</span> tempValue;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                data &gt;&gt; tempValue;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                probabilities.push_back( tempValue );</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        }</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">if</span>( segmentSeperator == label) { <span class="comment">// current pixel is from the same segment as the previous one</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            positionXSet.push_back( positionX );</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            positionYSet.push_back( positionY );</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            labelSet.push_back( label );</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            boarderIndexXSet.push_back( boarderIndexX );</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            boarderIndexYSet.push_back( boarderIndexY );</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            spectrumSet.push_back( spectrum );</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            probabilitiesSet.push_back( probabilities );</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="comment">//tempLines.push_back( line );</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="comment">// To decide if select current segments</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordflow">if</span>( !ifSelect ) {  <span class="comment">//if have not been marked as selected, check if to select</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i &lt; workingBoundaries.size(); i++) {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                    <span class="keywordflow">if</span>( workingBoundaries[i].direction == 0 ) { <span class="comment">// x direction (horizontal tiling boundary)</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                        <span class="keywordflow">if</span>( workingBoundaries[i].index == positionY ){</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                            <span class="keywordflow">if</span>( positionX &gt;= workingBoundaries[i].min &amp;&amp; positionX &lt;= workingBoundaries[i].max ) ifSelect = <span class="keyword">true</span>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                        }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                        <span class="keywordflow">if</span>( workingBoundaries[i].index == positionX ){</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                            <span class="keywordflow">if</span>( positionY &gt;= workingBoundaries[i].min &amp;&amp; positionY &lt;= workingBoundaries[i].max ) ifSelect = <span class="keyword">true</span>;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                        }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// current pixel is from a different segment as the previos one</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;             <span class="keywordflow">if</span>( ifSelect ) { <span class="comment">// the previous segments selected</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                 <span class="comment">//create node for these pixel (add model as well</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                 <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> k=0; k &lt; positionXSet.size(); k++) {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                     <a class="code" href="class_node.html">Node</a> *tempNode = <span class="keyword">new</span> <a class="code" href="class_node.html">Node</a>();</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                     tempNode-&gt;<a class="code" href="class_node.html#a2bfcbd3b82b596744f81432f1824d522">setPosition</a>( Point( positionXSet[k], positionYSet[k] ));</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                     <span class="comment">//remove boarder information</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                     <span class="keywordflow">if</span>( boarderIndexXSet[k] != 0) {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> l=0; l &lt; workingBoundaries.size(); l++) {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                 <span class="keywordflow">if</span>( workingBoundaries[l].direction == 1 ){</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                     <span class="keywordflow">if</span>( workingBoundaries[l].index == boarderIndexXSet[k] ){</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                         <span class="keywordflow">if</span>( positionYSet[k] &gt;= workingBoundaries[l].min &amp;&amp; positionYSet[k] &lt;= workingBoundaries[l].max ){</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                             boarderIndexXSet[k] = 0;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                         }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                     }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                 }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                         }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                         <span class="keywordflow">if</span>( boarderIndexXSet[k] != 0) tempNode-&gt;<a class="code" href="class_node.html#a9305e6376add78eafd94f198df0ee745">setBoarderIndexX</a>( boarderIndexXSet[k] );</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                     }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                     <span class="keywordflow">if</span>( boarderIndexYSet[k] != 0){</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> l=0; l &lt; workingBoundaries.size(); l++) {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                                 <span class="keywordflow">if</span>( workingBoundaries[l].direction == 0 ){</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                     <span class="keywordflow">if</span>( workingBoundaries[l].index == boarderIndexYSet[k] ) {</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                                         <span class="keywordflow">if</span>( positionXSet[k] &gt;= workingBoundaries[l].min &amp;&amp; positionXSet[k] &lt;= workingBoundaries[l].max ) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                             boarderIndexYSet[k] = 0;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                         }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                                     }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                                 }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                         }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                         <span class="keywordflow">if</span>( boarderIndexYSet[k] != 0 ) tempNode-&gt;<a class="code" href="class_node.html#aa969843e599c724456cc743b8b7f0f3b">setBoarderIndexY</a>( boarderIndexYSet[k] );</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                     }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                     tempNode-&gt;<a class="code" href="class_node.html#a195d6d2da0473a78a65cb501545859b7">ifLeaf</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                     <a class="code" href="classhistogram_model.html">histogramModel</a> * histogramModelTemp = <span class="keyword">new</span> <a class="code" href="classhistogram_model.html">histogramModel</a>( spectrumSet[k], this-&gt;nbins,  this-&gt;orderMin,  this-&gt;orderMax);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                     <span class="keywordflow">if</span>(this-&gt;ifAddProbabilityModel) {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                         <a class="code" href="classprobability_model.html">probabilityModel</a> *probabilityModelTemp = <span class="keyword">new</span> <a class="code" href="classprobability_model.html">probabilityModel</a>( probabilitiesSet[k] );</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                         <a class="code" href="classcompound_model.html">compoundModel</a> * compoundModelTemp = <span class="keyword">new</span> <a class="code" href="classcompound_model.html">compoundModel</a>( histogramModelTemp, probabilityModelTemp );</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                         tempNode-&gt;<a class="code" href="class_node.html#a8a60e0e373f3acf5a26036a0b40312a1">setModel</a>( compoundModelTemp );</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                     } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                         <a class="code" href="classcompound_model.html">compoundModel</a> * compoundModelTemp = <span class="keyword">new</span> <a class="code" href="classcompound_model.html">compoundModel</a>( histogramModelTemp);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                         tempNode-&gt;<a class="code" href="class_node.html#a8a60e0e373f3acf5a26036a0b40312a1">setModel</a>( compoundModelTemp );</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                     }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                     selected-&gt;push_back( tempNode );</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                 }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;             } <span class="keywordflow">else</span> { <span class="comment">// not selected, write them back to disk</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                 <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> k=0; k&lt;positionXSet.size(); k++){</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                     fout &lt;&lt; positionXSet[k] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; positionYSet[k] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; labelSet[k] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; boarderIndexXSet[k] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; boarderIndexYSet[k] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                     <span class="comment">// write spectrum info</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                     <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> l=0; l&lt; spectrumSet[k].size(); l++)</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                     {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                         fout &lt;&lt; spectrumSet[k][l] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                     }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                     <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel){</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                         <span class="comment">//write probability info</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                         <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> l=0; l&lt; probabilitiesSet[k].size(); l++)</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                         {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                             fout &lt;&lt; probabilitiesSet[k][l] &lt;&lt; <span class="stringliteral">&quot;    &quot;</span>;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                         }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                     }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                     fout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> ;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                 }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;             }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;             <span class="comment">//re-initial status for next segment</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;             positionXSet.clear();</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;             positionYSet.clear();</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;             labelSet.clear();</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;             boarderIndexXSet.clear();</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;             boarderIndexYSet.clear();</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;             spectrumSet.clear();</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;             probabilitiesSet.clear();</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;             <span class="comment">//tempLines.clear();</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;             ifSelect = <span class="keyword">false</span>;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;             segmentSeperator = label;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;             <span class="comment">//save the information of current pixel</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;             positionXSet.push_back( positionX );</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;             positionYSet.push_back( positionY );</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;             labelSet.push_back( label );</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;             boarderIndexXSet.push_back( boarderIndexX );</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;             boarderIndexYSet.push_back( boarderIndexY );</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;             spectrumSet.push_back( spectrum );</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;             probabilitiesSet.push_back( probabilities );</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;             <span class="comment">//tempLines.push_back( line );</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;             <span class="comment">// To decide if select current segments</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;             <span class="keywordflow">if</span>( !ifSelect ) {  <span class="comment">//if have not been marked as selected, check if to select</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                 <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i &lt; workingBoundaries.size(); i++) {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                     <span class="keywordflow">if</span>( workingBoundaries[i].direction == 0 ) { <span class="comment">// x direction (horizontal tiling boundary)</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                         <span class="keywordflow">if</span>( workingBoundaries[i].index == positionY ){</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                             <span class="keywordflow">if</span>( positionX &gt;= workingBoundaries[i].min &amp;&amp; positionX &lt;= workingBoundaries[i].max ) ifSelect = <span class="keyword">true</span>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                         }</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                     } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                         <span class="keywordflow">if</span>( workingBoundaries[i].index == positionX ){</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                             <span class="keywordflow">if</span>( positionY &gt;= workingBoundaries[i].min &amp;&amp; positionY &lt;= workingBoundaries[i].max ) ifSelect = <span class="keyword">true</span>;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                         }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                     }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                 }</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;             }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">if</span>( positionXSet.size() != 0 ) { <span class="comment">// process the last segment</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">if</span>( ifSelect ) { <span class="comment">//</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <span class="comment">//create node for these pixel (add model as well</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> k=0; k &lt; positionXSet.size(); k++) {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                <a class="code" href="class_node.html">Node</a> *tempNode = <span class="keyword">new</span> <a class="code" href="class_node.html">Node</a>();</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                tempNode-&gt;<a class="code" href="class_node.html#a2bfcbd3b82b596744f81432f1824d522">setPosition</a>( Point( positionXSet[k], positionYSet[k] ));</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                <span class="comment">//remove boarder information</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="keywordflow">if</span>( boarderIndexXSet[k] != 0) {</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> l=0; l &lt; workingBoundaries.size(); l++) {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                            <span class="keywordflow">if</span>( workingBoundaries[l].direction == 1 ){</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                <span class="keywordflow">if</span>( workingBoundaries[l].index == boarderIndexXSet[k] ){</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                    <span class="keywordflow">if</span>( positionYSet[k] &gt;= workingBoundaries[l].min &amp;&amp; positionYSet[k] &lt;= workingBoundaries[l].max ){</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                                        boarderIndexXSet[k] = 0;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                                    }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                            }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                    <span class="keywordflow">if</span>( boarderIndexXSet[k] != 0) tempNode-&gt;<a class="code" href="class_node.html#a9305e6376add78eafd94f198df0ee745">setBoarderIndexX</a>( boarderIndexXSet[k] );</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                }</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                <span class="keywordflow">if</span>( boarderIndexYSet[k] != 0){</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> l=0; l &lt; workingBoundaries.size(); l++) {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                            <span class="keywordflow">if</span>( workingBoundaries[l].direction == 0 ){</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                <span class="keywordflow">if</span>( workingBoundaries[l].index == boarderIndexYSet[k] ) {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                                    <span class="keywordflow">if</span>( positionXSet[k] &gt;= workingBoundaries[l].min &amp;&amp; positionXSet[k] &lt;= workingBoundaries[l].max ) {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                                        boarderIndexYSet[k] = 0;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                    }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                            }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    }</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    <span class="keywordflow">if</span>( boarderIndexYSet[k] != 0 ) tempNode-&gt;<a class="code" href="class_node.html#aa969843e599c724456cc743b8b7f0f3b">setBoarderIndexY</a>( boarderIndexYSet[k] );</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                tempNode-&gt;<a class="code" href="class_node.html#a195d6d2da0473a78a65cb501545859b7">ifLeaf</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                <a class="code" href="classhistogram_model.html">histogramModel</a> * histogramModelTemp = <span class="keyword">new</span> <a class="code" href="classhistogram_model.html">histogramModel</a>( spectrumSet[k], this-&gt;nbins,  this-&gt;orderMin,  this-&gt;orderMax);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="keywordflow">if</span>(this-&gt;ifAddProbabilityModel) {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                    <a class="code" href="classprobability_model.html">probabilityModel</a> *probabilityModelTemp = <span class="keyword">new</span> <a class="code" href="classprobability_model.html">probabilityModel</a>( probabilitiesSet[k] );</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    <a class="code" href="classcompound_model.html">compoundModel</a> * compoundModelTemp = <span class="keyword">new</span> <a class="code" href="classcompound_model.html">compoundModel</a>( histogramModelTemp, probabilityModelTemp );</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    tempNode-&gt;<a class="code" href="class_node.html#a8a60e0e373f3acf5a26036a0b40312a1">setModel</a>( compoundModelTemp );</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                    <a class="code" href="classcompound_model.html">compoundModel</a> * compoundModelTemp = <span class="keyword">new</span> <a class="code" href="classcompound_model.html">compoundModel</a>( histogramModelTemp);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                    tempNode-&gt;<a class="code" href="class_node.html#a8a60e0e373f3acf5a26036a0b40312a1">setModel</a>( compoundModelTemp );</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                selected-&gt;push_back( tempNode );</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            }</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// not selected, write them back to disk</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> k=0; k&lt;positionXSet.size(); k++){</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                fout &lt;&lt; positionXSet[k] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; positionYSet[k] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; labelSet[k] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; boarderIndexXSet[k] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; boarderIndexYSet[k] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="comment">// write spectrum info</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> l=0; l&lt; spectrumSet[k].size(); l++)</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                    fout &lt;&lt; spectrumSet[k][l] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                }</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel){</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                    <span class="comment">//write probability info</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> l=0; l&lt; probabilitiesSet[k].size(); l++)</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                    {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                        fout &lt;&lt; probabilitiesSet[k][l] &lt;&lt; <span class="stringliteral">&quot;    &quot;</span>;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                    }</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                fout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> ;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        }</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    fin.close();</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    fout.close();</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keyword">remove</span>(boarderFileName.c_str());</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    rename(fileNameOut.c_str(), boarderFileName.c_str() );</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;}</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno"><a class="line" href="classimage.html#a8a4c71e9c53353a4c65bb5f17122a9f4">  776</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#a3a11f9e84755d71dd86e6161f633dd80">image::saveToDisk</a>(<span class="keyword">const</span> std::vector&lt; Node *&gt; &amp;selectedSegmentationNodes, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> level)</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;{ <span class="comment">//write the regions in the segmentation which are not boarder regions anymore</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">//to the disk</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordtype">string</span> fileNameSegmentation = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/segmentation&quot;</span> + std::to_string(level) + <span class="stringliteral">&quot;.tif&quot;</span>;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordtype">string</span> fileNameSegmentationCSV = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/segmentation&quot;</span> + std::to_string(level) + <span class="stringliteral">&quot;.csv&quot;</span>;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    GDALDataset * classDataset;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel ){</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordtype">string</span> fileNameClassMap = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/classMap&quot;</span> + std::to_string(level) + <span class="stringliteral">&quot;.tif&quot;</span>;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        GDALAllRegister();</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        classDataset =  (GDALDataset *) GDALOpen( fileNameClassMap.c_str(), GA_Update);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keywordflow">if</span>( classDataset == NULL )</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        {</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            std::cout&lt;&lt; <span class="stringliteral">&quot;class map file open failed&quot;</span> &lt;&lt;endl;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            exit(1);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    }</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    GDALDataset * poDataset;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    GDALAllRegister();</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    poDataset =  (GDALDataset *) GDALOpen(fileNameSegmentation.c_str(), GA_Update );</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">if</span>( poDataset == NULL )</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    {</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        std::cout&lt;&lt; <span class="stringliteral">&quot;Segmentation file open failed&quot;</span> &lt;&lt;endl;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        exit(1);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    }</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    ofstream fout;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    fout.open(fileNameSegmentationCSV.c_str(), ios::app);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    ofstream fout_Boarder1;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="comment">//int row;</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    std::string boraderFileName = <span class="stringliteral">&quot;j&quot;</span> + to_string(row); <span class="comment">// should pass blockPosition</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    fout_Boarder1.open((boraderFileName).c_str(), ios::app);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt; selectedSegmentationNodes.size(); i++) {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keywordflow">if</span>(selectedSegmentationNodes[i]-&gt;getBoarderIndexX().size() == 0</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                &amp;&amp; selectedSegmentationNodes[i]-&gt;getBoarderIndexY().size() == 0) {<span class="comment">// if not boarders anymore</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="keywordtype">int</span> *color = <span class="keyword">new</span> <span class="keywordtype">int</span>[3];</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j &lt;3 ; j++){</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                <span class="keywordflow">if</span>(this-&gt;ifPaintRandomColor) {</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                    color[j] = std::rand()%255;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                    <span class="comment">//color[j] = ((int) nodeSet[i]-&gt;getMeanSpectrumAt(2-j))%255;</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                    color[j] = selectedSegmentationNodes[i]-&gt;getMeanSpectrumAt(j);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                }</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            }</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <a class="code" href="classio.html#aaa642111086b3ec2afee826a767d03ad">io::writeNodeToDisk</a>(selectedSegmentationNodes[i], color, poDataset, this-&gt;startPointX, this-&gt;startPointY );</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <a class="code" href="classio.html#a8aa97cb094b71a1583ef796b8200fbdb">io::writeNodeToCSV</a>(selectedSegmentationNodes[i], rand()%135797531, fout);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel ){</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                <a class="code" href="classio.html#a72962f4d8ddc9b57256730b089be4288">io::writeClassMap</a>( selectedSegmentationNodes[i], selectedSegmentationNodes[i]-&gt;getClassLabel() , classDataset, this-&gt;startPointX, this-&gt;startPointY );</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            }</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="keyword">delete</span>[] color;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="comment">// save too big segments to disk</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <span class="keywordflow">if</span>( selectedSegmentationNodes[i]-&gt;getArea() &gt; 3000000 ) {</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                <span class="keywordtype">int</span> *color = <span class="keyword">new</span> <span class="keywordtype">int</span>[3];</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j &lt;3 ; j++){</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                    <span class="keywordflow">if</span>(this-&gt;ifPaintRandomColor) {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                        color[j] = std::rand()%255;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                        <span class="comment">//color[j] = ((int) nodeSet[i]-&gt;getMeanSpectrumAt(2-j))%255;</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                        color[j] = selectedSegmentationNodes[i]-&gt;getMeanSpectrumAt(j);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                    }</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                <a class="code" href="classio.html#aaa642111086b3ec2afee826a767d03ad">io::writeNodeToDisk</a>(selectedSegmentationNodes[i], color, poDataset, this-&gt;startPointX, this-&gt;startPointY );</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                <a class="code" href="classio.html#a8aa97cb094b71a1583ef796b8200fbdb">io::writeNodeToCSV</a>(selectedSegmentationNodes[i], rand()%135797531, fout);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel ){</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    <a class="code" href="classio.html#a72962f4d8ddc9b57256730b089be4288">io::writeClassMap</a>( selectedSegmentationNodes[i], selectedSegmentationNodes[i]-&gt;getClassLabel() , classDataset, this-&gt;startPointX, this-&gt;startPointY );</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                <span class="keyword">delete</span>[] color;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( level ==0 ){</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                std::vector&lt;int&gt; borderIndexX = selectedSegmentationNodes[i]-&gt;getBoarderIndexX();</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                std::vector&lt;int&gt; borderIndexY = selectedSegmentationNodes[i]-&gt;getBoarderIndexY();</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                <span class="comment">// if borderIndexX.size == 1 save to the coressponding block</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                <span class="comment">// if borderIndexX.size == 2, save to the block which has priority</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                <span class="comment">// if borderIndexX.size == 0, save to correspoding row.</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                <span class="keywordflow">if</span>( borderIndexX.size() ==0 ) {</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                    <span class="keywordtype">int</span> label = std::rand()%135797531;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                    <a class="code" href="classio.html#a4cca3fdf98e917cac1b3e776c7634aec">io::writeBoarderNodeToCSV</a>( selectedSegmentationNodes[i] , label, fout_Boarder1, this-&gt;ifAddProbabilityModel);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                    qDebug() &lt;&lt; <span class="stringliteral">&quot;Save to j0&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( borderIndexX.size() == 1) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                    <span class="keywordtype">int</span> Index = borderIndexX[0];</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                    <span class="keywordtype">int</span> blockIndexX;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> indx = 0; indx &lt; this-&gt;nBlocksX; indx ++){</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                        <span class="keywordflow">if</span>( this-&gt;blocksStartPointX[indx] == Index){</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                            blockIndexX = indx;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                        }</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        <span class="keywordflow">if</span>( this-&gt;blocksStartPointX[indx] + this-&gt;blockSizeW[indx]-1 == Index){</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                            blockIndexX = indx;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                        }</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                    }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                    qDebug() &lt;&lt;<span class="stringliteral">&quot;Save to block&quot;</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; blockIndexX &lt;&lt; endl;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                    <span class="keywordflow">if</span>(blockIndexX == -1) qDebug() &lt;&lt; <span class="stringliteral">&quot;Bug found&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                    <span class="keywordtype">int</span> label = std::rand()%135797531;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                    ofstream fout_Boarder;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                    std::string tempBoraderFileName = <span class="stringliteral">&quot;i&quot;</span>+ to_string(blockIndexX)+ <span class="stringliteral">&quot;j&quot;</span> + to_string(row); <span class="comment">// should pass blockPosition</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                    fout_Boarder.open((tempBoraderFileName).c_str(), ios::app);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                    <a class="code" href="classio.html#a4cca3fdf98e917cac1b3e776c7634aec">io::writeBoarderNodeToCSV</a>( selectedSegmentationNodes[i] , label, fout_Boarder, this-&gt;ifAddProbabilityModel);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                    fout_Boarder.close();</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                    <span class="keywordtype">int</span> indexX1 = borderIndexX[0];</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                    <span class="keywordtype">int</span> indexX2 = borderIndexX[1]; <span class="comment">// indexX2 &gt; indexX1 this is important</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                    <span class="keywordflow">if</span>( indexX1 == indexX2) qDebug() &lt;&lt; <span class="stringliteral">&quot;There is one bug in save funtion&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                    <span class="keywordtype">int</span> blockIndexX1; <span class="comment">// = find( indexX1)</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    <span class="keywordtype">int</span> blockIndexX2; <span class="comment">// = find (indexX2)</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> indx = 0; indx &lt; this-&gt;nBlocksX; indx ++){</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                        <span class="keywordflow">if</span>( this-&gt;blocksStartPointX[indx] == indexX1){</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                            blockIndexX1 = indx;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                        }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                        <span class="keywordflow">if</span>( this-&gt;blocksStartPointX[indx] + this-&gt;blockSizeW[indx]-1 == indexX1){</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                            blockIndexX1 = indx;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                        }</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                    }</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> indx = 0; indx &lt; this-&gt;nBlocksX; indx ++){</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                        <span class="keywordflow">if</span>( this-&gt;blocksStartPointX[indx] == indexX2){</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                            blockIndexX2 = indx;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                        }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                        <span class="keywordflow">if</span>( this-&gt;blocksStartPointX[indx] + this-&gt;blockSizeW[indx]-1 == indexX2){</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                            blockIndexX2 = indx;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                        }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                    }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                    <span class="keywordtype">int</span> label = std::rand()%135797531;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                    <span class="comment">//decide which block to save</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    <span class="keywordtype">int</span> selected = -1;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <span class="keywordtype">int</span> circle = 1;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                    <span class="keywordflow">while</span>( selected == -1 ) {</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                        <span class="keywordflow">if</span>( ((blockIndexX1 - (<span class="keywordtype">int</span>)pow(2, circle))%((<span class="keywordtype">int</span>)pow(2, circle+1))) == 0 ){</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                            selected = blockIndexX1;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                        <span class="comment">/*</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">                       if( (blockIndexX1+1 - (int)pow(2, circle))%(int)pow(2, circle+1) == 0 ){</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">                           selected = blockIndexX1;</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">                       }</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">                       if( (blockIndexX2 - (int)pow(2, circle))%(int)pow(2, circle+1) == 0 ){</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">                           selected = blockIndexX2;</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">                       }</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">                       */</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                        <span class="keywordflow">if</span>( (blockIndexX2+1 - (<span class="keywordtype">int</span>)pow(2, circle))%(<span class="keywordtype">int</span>)pow(2, circle+1) == 0 ){</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                            selected = blockIndexX2;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                        }</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                        circle++;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                    }</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                    qDebug() &lt;&lt; <span class="stringliteral">&quot;A segment which has tow borders to block&quot;</span> &lt;&lt; blockIndexX1 &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; blockIndexX2 &lt;&lt; <span class="stringliteral">&quot;saved to block     &quot;</span>&lt;&lt;selected &lt;&lt; endl;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    ofstream fout_Boarder;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                    <span class="comment">//int row;</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                    std::string tempBoraderFileName = <span class="stringliteral">&quot;i&quot;</span>+ to_string(selected)+<span class="stringliteral">&quot;j&quot;</span> + to_string(row); <span class="comment">// should pass blockPosition</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                    fout_Boarder.open((tempBoraderFileName).c_str(), ios::app);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                    <a class="code" href="classio.html#a4cca3fdf98e917cac1b3e776c7634aec">io::writeBoarderNodeToCSV</a>( selectedSegmentationNodes[i] , label, fout_Boarder, this-&gt;ifAddProbabilityModel);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                    fout_Boarder.close();</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            }</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keyword">delete</span> poDataset;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel ) <span class="keyword">delete</span> classDataset;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    fout.close();</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    fout_Boarder1.close();</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;}</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno"><a class="line" href="classimage.html#a3a11f9e84755d71dd86e6161f633dd80">  988</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#a3a11f9e84755d71dd86e6161f633dd80">image::saveToDisk</a>(<span class="keyword">const</span> std::vector&lt; Node *&gt; &amp;selectedSegmentationNodes, <span class="keyword">const</span> std::vector&lt; WorkingBoundary &gt; &amp;workingBoundaries, <span class="keywordtype">int</span> level)</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;{ <span class="comment">//write the regions in the segmentation which are not boarder regions anymore</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="comment">//to the disk</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordtype">string</span> fileNameSegmentation = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/segmentation&quot;</span> + std::to_string(level) + <span class="stringliteral">&quot;.tif&quot;</span>;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordtype">string</span> fileNameSegmentationCSV = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/segmentation&quot;</span> + std::to_string(level) + <span class="stringliteral">&quot;.csv&quot;</span>;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    GDALDataset * classDataset;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel ){</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordtype">string</span> fileNameClassMap = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/classMap&quot;</span> + std::to_string(level) + <span class="stringliteral">&quot;.tif&quot;</span>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        GDALAllRegister();</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        classDataset =  (GDALDataset *) GDALOpen( fileNameClassMap.c_str(), GA_Update);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="keywordflow">if</span>( classDataset == NULL )</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        {</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            std::cout&lt;&lt; <span class="stringliteral">&quot;class map file open failed&quot;</span> &lt;&lt;endl;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            exit(1);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        }</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    }</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;   GDALDataset * poDataset;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   GDALAllRegister();</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;   poDataset =  (GDALDataset *) GDALOpen(fileNameSegmentation.c_str(), GA_Update );</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;   <span class="keywordflow">if</span>( poDataset == NULL )</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;   {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;       std::cout&lt;&lt; <span class="stringliteral">&quot;Segmentation file open failed&quot;</span> &lt;&lt;endl;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;       exit(1);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;   }</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;   ofstream fout;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;   fout.open(fileNameSegmentationCSV.c_str(), ios::app);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt; selectedSegmentationNodes.size(); i++) {</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;       <span class="keywordflow">if</span>(selectedSegmentationNodes[i]-&gt;getBoarderIndexX().size() == 0</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;               &amp;&amp; selectedSegmentationNodes[i]-&gt;getBoarderIndexY().size() == 0) {<span class="comment">// if not boarders anymore</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;           <span class="keywordtype">int</span> *color = <span class="keyword">new</span> <span class="keywordtype">int</span>[3];</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j &lt;3 ; j++){</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;               <span class="keywordflow">if</span>(this-&gt;ifPaintRandomColor) {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                   color[j] = std::rand()%255;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;               }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;               <span class="comment">//color[j] = ((int) nodeSet[i]-&gt;getMeanSpectrumAt(2-j))%255;</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;               color[j] = selectedSegmentationNodes[i]-&gt;getMeanSpectrumAt(j);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;               }</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;           }</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;           <a class="code" href="classio.html#aaa642111086b3ec2afee826a767d03ad">io::writeNodeToDisk</a>(selectedSegmentationNodes[i], color, poDataset, this-&gt;startPointX, this-&gt;startPointY );</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;           <a class="code" href="classio.html#a8aa97cb094b71a1583ef796b8200fbdb">io::writeNodeToCSV</a>(selectedSegmentationNodes[i], rand()%135797531, fout);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;           <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel ){</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;               <a class="code" href="classio.html#a72962f4d8ddc9b57256730b089be4288">io::writeClassMap</a>( selectedSegmentationNodes[i], selectedSegmentationNodes[i]-&gt;getClassLabel() , classDataset, this-&gt;startPointX, this-&gt;startPointY );</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;           }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;           <span class="keyword">delete</span>[] color;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;       } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;           <span class="comment">// save too big segments to disk</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;           <span class="keywordflow">if</span>( selectedSegmentationNodes[i]-&gt;getArea() &gt; 3000000 ) {</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;               <span class="keywordtype">int</span> *color = <span class="keyword">new</span> <span class="keywordtype">int</span>[3];</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j &lt;3 ; j++){</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                   <span class="keywordflow">if</span>(this-&gt;ifPaintRandomColor) {</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                       color[j] = std::rand()%255;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                   }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                   <span class="comment">//color[j] = ((int) nodeSet[i]-&gt;getMeanSpectrumAt(2-j))%255;</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                   color[j] = selectedSegmentationNodes[i]-&gt;getMeanSpectrumAt(j);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                   }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;               }</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;               <a class="code" href="classio.html#aaa642111086b3ec2afee826a767d03ad">io::writeNodeToDisk</a>(selectedSegmentationNodes[i], color, poDataset, this-&gt;startPointX, this-&gt;startPointY );</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;               <a class="code" href="classio.html#a8aa97cb094b71a1583ef796b8200fbdb">io::writeNodeToCSV</a>(selectedSegmentationNodes[i], rand()%135797531, fout);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;               <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel ){</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                   <a class="code" href="classio.html#a72962f4d8ddc9b57256730b089be4288">io::writeClassMap</a>( selectedSegmentationNodes[i], selectedSegmentationNodes[i]-&gt;getClassLabel() , classDataset, this-&gt;startPointX, this-&gt;startPointY );</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;               }</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;               <span class="keyword">delete</span>[] color;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;           } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( level == 0){</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;           <span class="comment">//save to the disk</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;               <span class="comment">//std::vector&lt;int&gt; borderIndexX = selectedSegmentationNodes[i]-&gt;getBoarderIndexX();</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;               std::vector&lt;int&gt; borderIndexY = selectedSegmentationNodes[i]-&gt;getBoarderIndexY();</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;               <span class="comment">// if the segment still is the border segments of the current working boundaries, then save back</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;               <span class="comment">// other wise</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;               <span class="comment">//          if borderIndexY.size() == 1 save to the croeesponding rows</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;               <span class="comment">//          if borderIndexY.size() == 2, find the place where to save, and save</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;               <span class="keywordtype">bool</span> ifSaveBack = <span class="keyword">false</span>;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;               <span class="keywordtype">int</span>  indexToSave;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;               <span class="keywordflow">for</span>( <span class="keywordtype">int</span> borderIndex=0; borderIndex &lt; borderIndexY.size(); borderIndex++){</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                   <span class="keywordflow">for</span>( <span class="keywordtype">int</span> workingBoundaryIndex=0; workingBoundaryIndex &lt; workingBoundaries.size(); workingBoundaryIndex++ ){</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                       <span class="keywordflow">if</span>( workingBoundaries[workingBoundaryIndex].direction == 0 &amp;&amp; workingBoundaries[workingBoundaryIndex].index == borderIndexY[borderIndex]){</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                           ifSaveBack = <span class="keyword">true</span>;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                           indexToSave = borderIndexY[borderIndex];</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                           <span class="keywordflow">break</span>;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                       }</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                   }</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;               }</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;               <span class="keywordflow">if</span>( ifSaveBack ){</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                   <span class="keywordtype">int</span> Index = indexToSave;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                   <span class="keywordtype">int</span> blockIndexY;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> indx = 0; indx &lt; this-&gt;nBlocksY; indx ++){</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                       <span class="keywordflow">if</span>( this-&gt;blocksStartPointY[indx] == Index){</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                           blockIndexY = indx;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                           <span class="keywordflow">break</span>;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                       }</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                       <span class="keywordflow">if</span>( this-&gt;blocksStartPointY[indx] + this-&gt;blockSizeH[indx]-1 == Index){</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                           blockIndexY = indx;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                           <span class="keywordflow">break</span>;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                       }</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                   }</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                   <span class="keywordtype">int</span> label = std::rand()%135797531;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                   ofstream fout_Boarder;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                   std::string tempBoraderFileName = <span class="stringliteral">&quot;j&quot;</span>+ to_string(blockIndexY); <span class="comment">// should pass blockPosition</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                   fout_Boarder.open((tempBoraderFileName).c_str(), ios::app);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                   <a class="code" href="classio.html#a4cca3fdf98e917cac1b3e776c7634aec">io::writeBoarderNodeToCSV</a>( selectedSegmentationNodes[i] , label, fout_Boarder, this-&gt;ifAddProbabilityModel);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                   fout_Boarder.close();</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;               }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;               <span class="keywordflow">if</span>( borderIndexY.size() == 1) {</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                   <span class="keywordtype">int</span> Index = borderIndexY[0];</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                   <span class="keywordtype">int</span> blockIndexY;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> indx = 0; indx &lt; this-&gt;nBlocksY; indx ++){</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                       <span class="keywordflow">if</span>( this-&gt;blocksStartPointY[indx] == Index){</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                           blockIndexY = indx;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                           <span class="keywordflow">break</span>;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                       }</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                       <span class="keywordflow">if</span>( this-&gt;blocksStartPointY[indx] + this-&gt;blockSizeH[indx]-1 == Index){</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                           blockIndexY = indx;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                           <span class="keywordflow">break</span>;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                       }</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                   }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                   qDebug() &lt;&lt;<span class="stringliteral">&quot;Save to block&quot;</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; blockIndexY &lt;&lt; endl;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                   <span class="keywordtype">int</span> label = std::rand()%135797531;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                   ofstream fout_Boarder;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                   std::string tempBoraderFileName = <span class="stringliteral">&quot;j&quot;</span>+ to_string(blockIndexY); <span class="comment">// should pass blockPosition</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                   fout_Boarder.open((tempBoraderFileName).c_str(), ios::app);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                   <a class="code" href="classio.html#a4cca3fdf98e917cac1b3e776c7634aec">io::writeBoarderNodeToCSV</a>( selectedSegmentationNodes[i] , label, fout_Boarder, this-&gt;ifAddProbabilityModel);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                   fout_Boarder.close();</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                   <span class="keywordtype">int</span> indexY1 = borderIndexY[0];</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                   <span class="keywordtype">int</span> indexY2 = borderIndexY[1]; <span class="comment">// indexX2 &gt; indexX1 this is important</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                   <span class="keywordflow">if</span>( indexY1 == indexY2) qDebug() &lt;&lt; <span class="stringliteral">&quot;There is one bug in save funtion&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                   <span class="keywordtype">int</span> blockIndexY1; <span class="comment">// = find( indexX1)</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                   <span class="keywordtype">int</span> blockIndexY2; <span class="comment">// = find (indexX2)</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> indx = 0; indx &lt; this-&gt;nBlocksY; indx ++){</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                       <span class="keywordflow">if</span>( this-&gt;blocksStartPointY[indx] == indexY1){</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                           blockIndexY1 = indx;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                           <span class="keywordflow">break</span>;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                       }</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                       <span class="keywordflow">if</span>( this-&gt;blocksStartPointY[indx] + this-&gt;blockSizeH[indx]-1 == indexY1){</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                           blockIndexY1 = indx;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                           <span class="keywordflow">break</span>;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                       }</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                   }</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> indx = 0; indx &lt; this-&gt;nBlocksY; indx ++){</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                       <span class="keywordflow">if</span>( this-&gt;blocksStartPointY[indx] == indexY2){</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                           blockIndexY2 = indx;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                           <span class="keywordflow">break</span>;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                       }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                       <span class="keywordflow">if</span>( this-&gt;blocksStartPointY[indx] + this-&gt;blockSizeH[indx]-1 == indexY2){</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                           blockIndexY2 = indx;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                           <span class="keywordflow">break</span>;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                       }</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                   }</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                   <span class="keywordtype">int</span> label = std::rand()%135797531;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                   <span class="comment">//decide which block to save</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                   <span class="keywordtype">int</span> selected = -1;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                   <span class="keywordtype">int</span> circle = 1;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                     <span class="keywordflow">while</span>( selected == -1 ) {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                       <span class="keywordflow">if</span>( ((blockIndexY1 - (<span class="keywordtype">int</span>)pow(2, circle))%((<span class="keywordtype">int</span>)pow(2, circle+1))) == 0 ){</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                           selected = blockIndexY1;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                       }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                       <span class="comment">/*</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">                       if( (blockIndexX1+1 - (int)pow(2, circle))%(int)pow(2, circle+1) == 0 ){</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">                           selected = blockIndexX1;</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">                       }</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">                       if( (blockIndexX2 - (int)pow(2, circle))%(int)pow(2, circle+1) == 0 ){</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">                           selected = blockIndexX2;</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">                       }</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">                       */</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                       <span class="keywordflow">if</span>( (blockIndexY2 + 1 - (<span class="keywordtype">int</span>)pow(2, circle))%(<span class="keywordtype">int</span>)pow(2, circle+1) == 0 ){</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                           selected = blockIndexY2;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                       }</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                       circle++;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                       <span class="keywordflow">if</span>(circle &gt;10) <span class="keywordflow">break</span>;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                     }</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                   qDebug() &lt;&lt; <span class="stringliteral">&quot;A segment which has tow borders to block&quot;</span> &lt;&lt; blockIndexY1 &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; blockIndexY2 &lt;&lt; <span class="stringliteral">&quot;saved to block     &quot;</span>&lt;&lt;selected &lt;&lt; endl;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                   ofstream fout_Boarder;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                   <span class="comment">//int row;</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                   std::string tempBoraderFileName = <span class="stringliteral">&quot;j&quot;</span>+ to_string(selected);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                   fout_Boarder.open((tempBoraderFileName).c_str(), ios::app);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                   <a class="code" href="classio.html#a4cca3fdf98e917cac1b3e776c7634aec">io::writeBoarderNodeToCSV</a>( selectedSegmentationNodes[i] , label, fout_Boarder, this-&gt;ifAddProbabilityModel);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                   fout_Boarder.close();</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;               }</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;               }</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;           }</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;       }</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;   }</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;   <span class="keyword">delete</span> poDataset;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;   <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel ) <span class="keyword">delete</span> classDataset;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;   fout.close();</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;}</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"><a class="line" href="classimage.html#a16c139a7a2ab7bb2c412f97d5abdcacd"> 1242</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#a16c139a7a2ab7bb2c412f97d5abdcacd">image::setGlobalSettings</a>(<span class="keywordtype">int</span> imageWidth, <span class="keywordtype">int</span> imageHeight,</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                              <span class="keywordtype">int</span> startPointX, <span class="keywordtype">int</span> startPointY,</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                              <span class="keywordtype">int</span> nBlocksX, <span class="keywordtype">int</span> nBlocksY,</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                              <span class="keywordtype">bool</span> ifDeleteNoise, <span class="keywordtype">double</span> nStdLeft, <span class="keywordtype">double</span> nStdRight,</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                              <span class="keywordtype">bool</span> ifUseMinimumToMerge, <span class="keywordtype">int</span> floor,</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                              <span class="keywordtype">int</span> nbins,</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                              <span class="keywordtype">bool</span> areaWeighted, <span class="keywordtype">double</span> areaExponent,</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                              <span class="keywordtype">bool</span> useStdCut,</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                              <span class="keywordtype">bool</span> ifAddProbabilityModel, <span class="keywordtype">double</span> probabilityModelWeight,</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                              <span class="keywordtype">int</span> nClasses, std::vector&lt;double&gt; lamda,</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                              <span class="keywordtype">bool</span> ifPaintRandomColor)</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;{</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    this-&gt;<a class="code" href="classimage.html#ad86284aa4e8e75cfc904084479146f2f">linkFile</a>();</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    this-&gt;ifDeleteNoise = ifDeleteNoise;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">if</span>( ifDeleteNoise ) {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        this-&gt;nStdLeft = nStdLeft;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        this-&gt;nStdRight = nStdRight;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    this-&gt;ifPaintRandomColor = ifPaintRandomColor;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    this-&gt;ifUseMinimumToMerge = ifUseMinimumToMerge;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    this-&gt;floor = floor;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    this-&gt;useStdCut = useStdCut;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    this-&gt;ifAddProbabilityModel = ifAddProbabilityModel;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    this-&gt;probabilityModelWeight = probabilityModelWeight;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    this-&gt;nClasses = nClasses;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="comment">//Set raster image information</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    this-&gt;rasterWidth = this-&gt;data-&gt;GetRasterXSize();</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    this-&gt;rasterHeight = this-&gt;data-&gt;GetRasterYSize();</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    this-&gt;rasterBandCount = this-&gt;data-&gt;GetRasterCount();</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="comment">//Check if the image settings out of range, if yes, re set the width and height</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordflow">if</span>( imageWidth+startPointX &gt; this-&gt;data-&gt;GetRasterXSize()) {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        QMessageBox::warning(NULL, <span class="stringliteral">&quot;Warming!&quot;</span>,  <span class="stringliteral">&quot;Image width out of range! &quot;</span>);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        imageWidth = this-&gt;data-&gt;GetRasterXSize() - startPointX;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    }</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">if</span>(imageHeight+startPointY &gt; this-&gt;data-&gt;GetRasterYSize()) {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        QMessageBox::warning(NULL, <span class="stringliteral">&quot;Warming!&quot;</span>,  <span class="stringliteral">&quot;Image height out of range! &quot;</span>);</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        imageHeight = this-&gt;data-&gt;GetRasterXSize() - startPointY;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    }</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="comment">// If the image width is 0, set the imageWidth to be to the size start from startPointX,</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">// do the same to imageHeight</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    this-&gt;imageWidth = imageWidth;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    this-&gt;imageHeight = imageHeight;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keywordflow">if</span>(imageWidth == 0)   this-&gt;imageWidth = this-&gt;data-&gt;GetRasterXSize() - startPointX ;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">if</span>(imageHeight == 0)  this-&gt;imageHeight = this-&gt;data-&gt;GetRasterYSize() - startPointY;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    this-&gt;nBands = this-&gt;data-&gt;GetRasterCount();</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    this-&gt;nBlocksX = nBlocksX;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    this-&gt;nBlocksY = nBlocksY;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    this-&gt;startPointX = startPointX;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    this-&gt;startPointY = startPointY;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    this-&gt;areaWeighted = areaWeighted;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    this-&gt;areaExponent = areaExponent;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    this-&gt;floor = floor;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    this-&gt;lamda = lamda;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    this-&gt;nbins = nbins;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    this-&gt;<a class="code" href="classimage.html#a6d7fac910481c15802515c36463cfffa">blockSizeCalculator_evenSplite</a>();</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    this-&gt;<a class="code" href="classimage.html#a8a1a7543a50f78a8c07d4a35560ad7ab">blockStartPointCalculator_evenSplite</a>();</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">// set the file names where to store the segmentation</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keywordflow">if</span>( ! this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a>.empty() ){</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        this-&gt;fileNameSegmentation = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/segmentation.tif&quot;</span>;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        this-&gt;logFileName = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/logFile&quot;</span>;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        this-&gt;fileNameSegmentationCSV = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/segmentation.csv&quot;</span>;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        this-&gt;fileNameSegmentation = <span class="stringliteral">&quot;segmentation.tif&quot;</span>;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        this-&gt;logFileName = <span class="stringliteral">&quot;logFile&quot;</span>;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        this-&gt;fileNameSegmentationCSV = <span class="stringliteral">&quot;segmentation.csv&quot;</span>;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    }</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i &lt; this-&gt;lamda.size(); i++){</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        std::string fileNameSegmentation = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/segmentation&quot;</span> + std::to_string(i) + <span class="stringliteral">&quot;.tif&quot;</span>;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        std::string fileNameSegmentationCSV = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/segmentation&quot;</span> + std::to_string(i) + <span class="stringliteral">&quot;.csv&quot;</span>;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        this-&gt;<a class="code" href="classimage.html#aa3cb332287f2c67f7ab68cfcc386bcd2">createEmptyImage</a>(fileNameSegmentation);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        this-&gt;<a class="code" href="classimage.html#aa50311604615c5027bee9b24cfab49a8">createEmptyCSV</a>(fileNameSegmentationCSV );</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="keywordflow">if</span>( this-&gt;ifAddProbabilityModel ){</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            std::string fileNameClassMap = this-&gt;<a class="code" href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">directoryOutput</a> + <span class="stringliteral">&quot;/classMap&quot;</span> + std::to_string(i) + <span class="stringliteral">&quot;.tif&quot;</span>;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            <span class="comment">//io::createEmptyImage( fileNameClassMap, this-&gt;imageWidth, this-&gt;imageHeight, 3);</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            this-&gt;<a class="code" href="classimage.html#aa3cb332287f2c67f7ab68cfcc386bcd2">createEmptyImage</a>(fileNameClassMap);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        }</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    }</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    this-&gt;<a class="code" href="classimage.html#a95002c780c2c4c6764d01fa4f850f775">SetStatistics</a>();</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <a class="code" href="classcompound_model.html#aa449c821f249e177001ce13d25485c99">compoundModel::areaWeighted</a> = this-&gt;areaWeighted;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <a class="code" href="classcompound_model.html#a3d76a3d82271411610ef987b8e9c7d72">compoundModel::areaExponent</a> = this-&gt;areaExponent;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <a class="code" href="classcompound_model.html#a49d04b3fa65ec05bfdc3bc4968b63c29">compoundModel::floor</a> = this-&gt;floor;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <a class="code" href="classcompound_model.html#a70206be55657655b73a7a03c54bd258c">compoundModel::ifUseMinimumToMerge</a> = this-&gt;ifUseMinimumToMerge;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <a class="code" href="classcompound_model.html#a5cc93a5c3cd30c39cde1d8c6d8c70cd4">compoundModel::probabilityModelWeight</a> = this-&gt;probabilityModelWeight;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="comment">//Set preprocessing information</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    std::cout&lt;&lt;<span class="stringliteral">&quot;Parameters have been set successfully.&quot;</span> &lt;&lt;std::endl;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;}</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"><a class="line" href="classimage.html#aa7ee2af9cc80df285e7ae593e0b457c1"> 1367</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#aa7ee2af9cc80df285e7ae593e0b457c1">image::print_ImageInfo</a>()</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;{<span class="comment">// print out some basic information about the image which we are going to process</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="comment">//print image format</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordflow">switch</span> (this-&gt;imageFormat) {</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaafad84bb170ef6e1eaf6db062c95d4d29">U8I</a> : std::cout &lt;&lt; <span class="stringliteral">&quot;Processing eight bit unsigned integer image &quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaad5d8b5731dfb8fa24e8523b2ebffdf7f">U16I</a> :std::cout &lt;&lt; <span class="stringliteral">&quot;Processing sixteen bit unsigned integer image&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa181e4b80585669687eae4cb4a527397e">S16I</a> :std::cout &lt;&lt; <span class="stringliteral">&quot;Processing sixteen bit signed integer image&quot;</span> &lt;&lt;endl;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa234e6937916f66a485971765c6bb5a8b">U32I</a> :std::cout &lt;&lt; <span class="stringliteral">&quot;Processing thirty two bit unsigned inter image&quot;</span> &lt;&lt;endl;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaadf7d8480a3f600d86f4285decd4cad8d">S32I</a> : std::cout &lt;&lt; <span class="stringliteral">&quot;Processing thirty two bit signed inter image&quot;</span> &lt;&lt;endl;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa90ded373041ca522cbec296a8d0f31d9">F32</a> :std::cout &lt;&lt; <span class="stringliteral">&quot;Processing thirty two bit floating point image&quot;</span> &lt;&lt;endl;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa3943835df9d39a82c801bc9c7081869b">F64</a> :std::cout &lt;&lt; <span class="stringliteral">&quot;Processing sixty four bit floating point image&quot;</span> &lt;&lt;endl;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">default</span>: exit(1);</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    }</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="comment">// print image size</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    std::cout&lt;&lt;<span class="stringliteral">&quot;Image size :  &quot;</span> &lt;&lt; this-&gt;imageWidth &lt;&lt; <span class="stringliteral">&quot; * &quot;</span>&lt;&lt; this-&gt;imageHeight &lt;&lt; endl</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        &lt;&lt;<span class="stringliteral">&quot;Number of bands : &quot;</span> &lt;&lt; this-&gt;nBands &lt;&lt; endl;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;}</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"><a class="line" href="classimage.html#a6d7fac910481c15802515c36463cfffa"> 1399</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#a6d7fac910481c15802515c36463cfffa">image::blockSizeCalculator_evenSplite</a>()</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;{  <span class="comment">// this function evenly splite the image</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    blockSizeW.clear();</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    blockSizeH.clear();</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="keywordtype">int</span> eachSizeX = imageWidth/nBlocksX;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordtype">int</span> eachSizeY = imageHeight/nBlocksY;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i= 0;i&lt; nBlocksX-1; i++ )</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        blockSizeW.push_back(eachSizeX);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    blockSizeW.push_back(imageWidth - eachSizeX*(nBlocksX-1));</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nBlocksY-1; j++)</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        blockSizeH.push_back(eachSizeY);</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    blockSizeH.push_back(imageHeight- eachSizeY*(nBlocksY-1));</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;}</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div><div class="line"><a name="l01421"></a><span class="lineno"><a class="line" href="classimage.html#a8a1a7543a50f78a8c07d4a35560ad7ab"> 1421</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#a8a1a7543a50f78a8c07d4a35560ad7ab">image::blockStartPointCalculator_evenSplite</a>()</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;{</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    blocksStartPointX.clear();</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    blocksStartPointY.clear();</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    blocksStartPointX.push_back(startPointX);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    blocksStartPointY.push_back(startPointY);</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i= 1; i &lt; nBlocksX; i++)</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        blocksStartPointX.push_back(blocksStartPointX[i-1] + blockSizeW[i-1]);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=1; j &lt; nBlocksY; j++)</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        blocksStartPointY.push_back(blocksStartPointY[j-1]+ blockSizeH[j-1]);</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;}</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">void this-&gt;createEmptyImage(std::string fileName){</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">    Mat segmentation = Mat::zeros(imageHeight,imageWidth, CV_8UC3);</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">    //imwrite(&quot;segmentationAll.tif&quot;,segmentation);</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">    imwrite(fileName,segmentation);</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment">}</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"><a class="line" href="classimage.html#aa3cb332287f2c67f7ab68cfcc386bcd2"> 1448</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#aa3cb332287f2c67f7ab68cfcc386bcd2">image::createEmptyImage</a>(std::string fileName)</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;{</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    GDALAllRegister();</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;   <span class="comment">// GDALRegister_GTiff();</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *pszFormat = <span class="stringliteral">&quot;GTiff&quot;</span>;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    GDALDriver *poDriver = GetGDALDriverManager()-&gt;GetDriverByName( pszFormat );</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="comment">//GDALRegisterDriver( poDriver);</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;   <span class="comment">// char **papszMetadata = poDriver-&gt;GetMetadata();</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="comment">// set some options http://www.gdal.org/frmt_gtiff.html</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="keywordtype">char</span> **papszOptions = NULL;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="comment">//papszOptions = CSLSetNameValue( papszOptions, &quot;TFW&quot;, &quot;NO&quot; );</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    papszOptions = CSLSetNameValue( papszOptions, <span class="stringliteral">&quot;TILED&quot;</span>, <span class="stringliteral">&quot;NO&quot;</span> );</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">//const char *options = GDALGetDriverCreationOptionList(poDriver);</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    papszOptions = CSLSetNameValue( papszOptions,<span class="stringliteral">&quot;BIGTIFF&quot;</span>, <span class="stringliteral">&quot;IF_NEEDED&quot;</span> );</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordtype">int</span> nBandCount = 3;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordtype">int</span> width = this-&gt;imageWidth;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordtype">int</span> height = this-&gt;imageHeight;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="comment">//check if file existed</span></div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;   <span class="comment">// remove( fileName.c_str() );</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    GDALDataset *poDataset;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    poDataset= poDriver-&gt;Create(fileName.c_str(),width,height,nBandCount,GDT_Byte,papszOptions);</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keyword">delete</span> poDataset;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">//delete poDriver;</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <span class="comment">// GetGDALDriverManager()-&gt;DeregisterDriver( poDriver);</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="comment">//  GetGDALDriverManager()-&gt;AutoSkipDrivers();</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;}</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div><div class="line"><a name="l01489"></a><span class="lineno"><a class="line" href="classimage.html#aa50311604615c5027bee9b24cfab49a8"> 1489</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#aa50311604615c5027bee9b24cfab49a8">image::createEmptyCSV</a>(std::string fileName)</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;{</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">if</span> (FILE *file = fopen(fileName.c_str(), <span class="stringliteral">&quot;r&quot;</span>)) {</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        fclose(file);</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        std::cout&lt;&lt;fileName &lt;&lt;<span class="stringliteral">&quot; already exists. Do you want to delete it ?&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordtype">bool</span> ifDeleteFile = <span class="keyword">true</span>;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        <span class="comment">//cin&gt;&gt;ifDeleteFile; // let the user to choose if to delete it or not</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="keywordflow">if</span>(ifDeleteFile) {</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            <span class="keyword">remove</span>(fileName.c_str());</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;            exit(1);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        }</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    }</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="comment">//create a new file</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    ofstream out;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    out.open(fileName.c_str());</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    out.close();</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="keywordflow">return</span>;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;}</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"><a class="line" href="classimage.html#a95002c780c2c4c6764d01fa4f850f775"> 1515</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classimage.html#a95002c780c2c4c6764d01fa4f850f775">image::SetStatistics</a>()</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;{<span class="comment">//Fetch image statistics</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="comment">//clean the statistics infor</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    this-&gt;rasterMin.clear();</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    this-&gt;rasterMax.clear();</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    this-&gt;rasterMean.clear();</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    this-&gt;rasterStdDev.clear();</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    this-&gt;orderMin.clear();</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    this-&gt;orderMax.clear();</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; this-&gt;rasterBandCount; i++) {</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        GDALRasterBand * rasterBand = this-&gt;data-&gt;GetRasterBand(i+1);</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        <span class="keywordtype">int</span> bApproxOK = 0;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        <span class="keywordtype">int</span> bForce = 1;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <span class="keywordtype">double</span> min=0;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="keywordtype">double</span> max=0;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="keywordtype">double</span> mean=0;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="keywordtype">double</span> stdDev=0;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        <span class="keywordflow">if</span>(!rasterBand-&gt;GetStatistics(bApproxOK, bForce, &amp;min, &amp;max, &amp;mean, &amp;stdDev)){</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            <span class="comment">//rasterBand-&gt;ComputeStatistics( bApproxOK, &amp;min, &amp;max, &amp;mean, &amp;stdDev, NULL, NULL);</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        }</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        this-&gt;rasterMin.push_back(min);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        this-&gt;rasterMax.push_back(max);</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        this-&gt;rasterMean.push_back(mean);</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        this-&gt;rasterStdDev.push_back(stdDev);</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        <span class="keywordflow">if</span>(this-&gt;ifDeleteNoise) {</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            this-&gt;orderMin.push_back( this-&gt;rasterMean[i] - this-&gt;nStdLeft*this-&gt;rasterStdDev[i] );</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            this-&gt;orderMax.push_back( this-&gt;rasterMean[i] + this-&gt;nStdRight*this-&gt;rasterStdDev[i] );</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            this-&gt;orderMin.push_back(min);</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            this-&gt;orderMax.push_back(max);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        }</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    }</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;}</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="ttc" id="class_node_html_a195d6d2da0473a78a65cb501545859b7"><div class="ttname"><a href="class_node.html#a195d6d2da0473a78a65cb501545859b7">Node::ifLeaf</a></div><div class="ttdeci">bool ifLeaf</div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00119">node.h:119</a></div></div>
<div class="ttc" id="enumerators_8h_html_af271aa044205af3808f72dbfb401bfdaafad84bb170ef6e1eaf6db062c95d4d29"><div class="ttname"><a href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaafad84bb170ef6e1eaf6db062c95d4d29">U8I</a></div><div class="ttdef"><b>Definition:</b> <a href="enumerators_8h_source.html#l00017">enumerators.h:17</a></div></div>
<div class="ttc" id="classio_html_a665eff0517fb9afbded1a2a7db62e1d7"><div class="ttname"><a href="classio.html#a665eff0517fb9afbded1a2a7db62e1d7">io::bestSegmentation</a></div><div class="ttdeci">static void bestSegmentation(Node *n, std::vector&lt; Node * &gt; &amp;selectedNodes, double &amp;cost, double lamda, bool useStdCut)</div><div class="ttdef"><b>Definition:</b> <a href="io_8cpp_source.html#l00424">io.cpp:424</a></div></div>
<div class="ttc" id="classimage_html_aaad80e489cb7ecf01f2706a3a18ac816"><div class="ttname"><a href="classimage.html#aaad80e489cb7ecf01f2706a3a18ac816">image::directoryProbabilities</a></div><div class="ttdeci">std::string directoryProbabilities</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00091">image.h:91</a></div></div>
<div class="ttc" id="classimage_html_ad8f92b1e7e0d07c12286ca2cd7163472"><div class="ttname"><a href="classimage.html#ad8f92b1e7e0d07c12286ca2cd7163472">image::PrintTileInfo</a></div><div class="ttdeci">void PrintTileInfo(int indexX, int indexY)</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00244">image.cpp:244</a></div></div>
<div class="ttc" id="classimage_html_a8a1a7543a50f78a8c07d4a35560ad7ab"><div class="ttname"><a href="classimage.html#a8a1a7543a50f78a8c07d4a35560ad7ab">image::blockStartPointCalculator_evenSplite</a></div><div class="ttdeci">void blockStartPointCalculator_evenSplite()</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l01421">image.cpp:1421</a></div></div>
<div class="ttc" id="classhistogram_model_html"><div class="ttname"><a href="classhistogram_model.html">histogramModel</a></div><div class="ttdef"><b>Definition:</b> <a href="histogrammodel_8h_source.html#l00030">histogrammodel.h:30</a></div></div>
<div class="ttc" id="classcompound_model_html"><div class="ttname"><a href="classcompound_model.html">compoundModel</a></div><div class="ttdef"><b>Definition:</b> <a href="compoundmodel_8h_source.html#l00029">compoundmodel.h:29</a></div></div>
<div class="ttc" id="class_node_html"><div class="ttname"><a href="class_node.html">Node</a></div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00051">node.h:51</a></div></div>
<div class="ttc" id="classimage_html_a95002c780c2c4c6764d01fa4f850f775"><div class="ttname"><a href="classimage.html#a95002c780c2c4c6764d01fa4f850f775">image::SetStatistics</a></div><div class="ttdeci">void SetStatistics()</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l01515">image.cpp:1515</a></div></div>
<div class="ttc" id="classimage_html_a6d7fac910481c15802515c36463cfffa"><div class="ttname"><a href="classimage.html#a6d7fac910481c15802515c36463cfffa">image::blockSizeCalculator_evenSplite</a></div><div class="ttdeci">void blockSizeCalculator_evenSplite()</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l01399">image.cpp:1399</a></div></div>
<div class="ttc" id="classcompound_model_html_a49d04b3fa65ec05bfdc3bc4968b63c29"><div class="ttname"><a href="classcompound_model.html#a49d04b3fa65ec05bfdc3bc4968b63c29">compoundModel::floor</a></div><div class="ttdeci">static long floor</div><div class="ttdef"><b>Definition:</b> <a href="compoundmodel_8h_source.html#l00074">compoundmodel.h:74</a></div></div>
<div class="ttc" id="enumerators_8h_html_af271aa044205af3808f72dbfb401bfdaad5d8b5731dfb8fa24e8523b2ebffdf7f"><div class="ttname"><a href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaad5d8b5731dfb8fa24e8523b2ebffdf7f">U16I</a></div><div class="ttdef"><b>Definition:</b> <a href="enumerators_8h_source.html#l00017">enumerators.h:17</a></div></div>
<div class="ttc" id="classimage_html_a3a11f9e84755d71dd86e6161f633dd80"><div class="ttname"><a href="classimage.html#a3a11f9e84755d71dd86e6161f633dd80">image::saveToDisk</a></div><div class="ttdeci">void saveToDisk(const std::vector&lt; Node * &gt; &amp;selectedSegmentationNodes, const std::vector&lt; WorkingBoundary &gt; &amp;workingBoundaries, int level)</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00988">image.cpp:988</a></div></div>
<div class="ttc" id="classimage_html_a83026280ad6cc713ec9489ff3bd9776e"><div class="ttname"><a href="classimage.html#a83026280ad6cc713ec9489ff3bd9776e">image::ProcessBoundaryX</a></div><div class="ttdeci">void ProcessBoundaryX()</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00088">image.cpp:88</a></div></div>
<div class="ttc" id="classimage_html_ad6a93f077adf016681ef4fb0f6817b78"><div class="ttname"><a href="classimage.html#ad6a93f077adf016681ef4fb0f6817b78">image::directoryOutput</a></div><div class="ttdeci">std::string directoryOutput</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00090">image.h:90</a></div></div>
<div class="ttc" id="classio_html_a8aa97cb094b71a1583ef796b8200fbdb"><div class="ttname"><a href="classio.html#a8aa97cb094b71a1583ef796b8200fbdb">io::writeNodeToCSV</a></div><div class="ttdeci">static void writeNodeToCSV(Node *node, int label, ofstream &amp;fout)</div><div class="ttdef"><b>Definition:</b> <a href="io_8cpp_source.html#l00315">io.cpp:315</a></div></div>
<div class="ttc" id="enumerators_8h_html_af271aa044205af3808f72dbfb401bfdaa90ded373041ca522cbec296a8d0f31d9"><div class="ttname"><a href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa90ded373041ca522cbec296a8d0f31d9">F32</a></div><div class="ttdef"><b>Definition:</b> <a href="enumerators_8h_source.html#l00017">enumerators.h:17</a></div></div>
<div class="ttc" id="classimage_html_aa3cb332287f2c67f7ab68cfcc386bcd2"><div class="ttname"><a href="classimage.html#aa3cb332287f2c67f7ab68cfcc386bcd2">image::createEmptyImage</a></div><div class="ttdeci">void createEmptyImage(std::string fileName)</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l01448">image.cpp:1448</a></div></div>
<div class="ttc" id="classimage_html_ad5a9d767eca6f9bbb8dcb556527edf4d"><div class="ttname"><a href="classimage.html#ad5a9d767eca6f9bbb8dcb556527edf4d">image::ProcessTiles</a></div><div class="ttdeci">void ProcessTiles()</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00040">image.cpp:40</a></div></div>
<div class="ttc" id="class_r_a_g_html_ab09eebb1b704d18b583d528e77f7604a"><div class="ttname"><a href="class_r_a_g.html#ab09eebb1b704d18b583d528e77f7604a">RAG::regionMerging</a></div><div class="ttdeci">Node * regionMerging()</div><div class="ttdef"><b>Definition:</b> <a href="rag_8cpp_source.html#l00065">rag.cpp:65</a></div></div>
<div class="ttc" id="compoundmodel_8h_html"><div class="ttname"><a href="compoundmodel_8h.html">compoundmodel.h</a></div></div>
<div class="ttc" id="classimageblock_html_aa28c36c8019b54006331c050484d0701"><div class="ttname"><a href="classimageblock.html#aa28c36c8019b54006331c050484d0701">imageblock::setParameters</a></div><div class="ttdeci">void setParameters(int indexX, int indexY, GDALDataset *data, int blockSizeX, int blockSizeY, int blockStartX, int blockStartY, int globalSizeX, int globalSizeY, int globalStartX, int globalStartY, IMAGEFORMAT imageFormat, bool ifDeleteNoise, std::vector&lt; double &gt; orderMin, std::vector&lt; double &gt; orderMax, bool ifAddProbabilityModel, int nClasses, int nBins, bool useStdCut, std::string directoryOutput, std::string directoryProbabilities, bool ifPaintRandomColor, std::vector&lt; double &gt; lamda)</div><div class="ttdef"><b>Definition:</b> <a href="imageblock_8cpp_source.html#l00061">imageblock.cpp:61</a></div></div>
<div class="ttc" id="image_8h_html"><div class="ttname"><a href="image_8h.html">image.h</a></div></div>
<div class="ttc" id="classcompound_model_html_a70206be55657655b73a7a03c54bd258c"><div class="ttname"><a href="classcompound_model.html#a70206be55657655b73a7a03c54bd258c">compoundModel::ifUseMinimumToMerge</a></div><div class="ttdeci">static bool ifUseMinimumToMerge</div><div class="ttdef"><b>Definition:</b> <a href="compoundmodel_8h_source.html#l00075">compoundmodel.h:75</a></div></div>
<div class="ttc" id="class_r_a_g_html"><div class="ttname"><a href="class_r_a_g.html">RAG</a></div><div class="ttdef"><b>Definition:</b> <a href="rag_8h_source.html#l00043">rag.h:43</a></div></div>
<div class="ttc" id="classimage_html_a7934adc398c4b1c001fe38b0500e8341"><div class="ttname"><a href="classimage.html#a7934adc398c4b1c001fe38b0500e8341">image::selectBoarderSegments</a></div><div class="ttdeci">void selectBoarderSegments(std::vector&lt; Node * &gt; *selected, const std::vector&lt; WorkingBoundary &gt; &amp;workingBoundaries, std::string boarderFileName)</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00453">image.cpp:453</a></div></div>
<div class="ttc" id="classimageblock_html"><div class="ttname"><a href="classimageblock.html">imageblock</a></div><div class="ttdef"><b>Definition:</b> <a href="imageblock_8h_source.html#l00027">imageblock.h:27</a></div></div>
<div class="ttc" id="classimage_html_ad86284aa4e8e75cfc904084479146f2f"><div class="ttname"><a href="classimage.html#ad86284aa4e8e75cfc904084479146f2f">image::linkFile</a></div><div class="ttdeci">void linkFile()</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00222">image.cpp:222</a></div></div>
<div class="ttc" id="class_working_boundary_html"><div class="ttname"><a href="class_working_boundary.html">WorkingBoundary</a></div><div class="ttdef"><b>Definition:</b> <a href="workingboundary_8h_source.html#l00019">workingboundary.h:19</a></div></div>
<div class="ttc" id="classimageblock_html_af3b91e3daaa8014af1239f60da6b0bf5"><div class="ttname"><a href="classimageblock.html#af3b91e3daaa8014af1239f60da6b0bf5">imageblock::processing</a></div><div class="ttdeci">void processing()</div><div class="ttdef"><b>Definition:</b> <a href="imageblock_8cpp_source.html#l00116">imageblock.cpp:116</a></div></div>
<div class="ttc" id="classimage_html_aa7ee2af9cc80df285e7ae593e0b457c1"><div class="ttname"><a href="classimage.html#aa7ee2af9cc80df285e7ae593e0b457c1">image::print_ImageInfo</a></div><div class="ttdeci">void print_ImageInfo()</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l01367">image.cpp:1367</a></div></div>
<div class="ttc" id="classimage_html_a12343719e8d96a4bda9c5bd6c035d52a"><div class="ttname"><a href="classimage.html#a12343719e8d96a4bda9c5bd6c035d52a">image::mergeBlockX</a></div><div class="ttdeci">void mergeBlockX(const std::vector&lt; WorkingBoundary &gt; &amp;workingBoundaries, const std::vector&lt; int &gt; &amp;blockPosition1, const std::vector&lt; int &gt; &amp;blockPosition2)</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00285">image.cpp:285</a></div></div>
<div class="ttc" id="enumerators_8h_html_af271aa044205af3808f72dbfb401bfdaadf7d8480a3f600d86f4285decd4cad8d"><div class="ttname"><a href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaadf7d8480a3f600d86f4285decd4cad8d">S32I</a></div><div class="ttdef"><b>Definition:</b> <a href="enumerators_8h_source.html#l00017">enumerators.h:17</a></div></div>
<div class="ttc" id="class_node_html_aa969843e599c724456cc743b8b7f0f3b"><div class="ttname"><a href="class_node.html#aa969843e599c724456cc743b8b7f0f3b">Node::setBoarderIndexY</a></div><div class="ttdeci">void setBoarderIndexY(int y)</div><div class="ttdef"><b>Definition:</b> <a href="node_8cpp_source.html#l00296">node.cpp:296</a></div></div>
<div class="ttc" id="classprobability_model_html"><div class="ttname"><a href="classprobability_model.html">probabilityModel</a></div><div class="ttdef"><b>Definition:</b> <a href="probabilitymodel_8h_source.html#l00025">probabilitymodel.h:25</a></div></div>
<div class="ttc" id="classio_html_a72962f4d8ddc9b57256730b089be4288"><div class="ttname"><a href="classio.html#a72962f4d8ddc9b57256730b089be4288">io::writeClassMap</a></div><div class="ttdeci">static void writeClassMap(Node *node, int classLabel, GDALDataset *poDataset, int globalStartX, int globalStartY)</div><div class="ttdef"><b>Definition:</b> <a href="io_8cpp_source.html#l00284">io.cpp:284</a></div></div>
<div class="ttc" id="enumerators_8h_html_af271aa044205af3808f72dbfb401bfdaa3943835df9d39a82c801bc9c7081869b"><div class="ttname"><a href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa3943835df9d39a82c801bc9c7081869b">F64</a></div><div class="ttdef"><b>Definition:</b> <a href="enumerators_8h_source.html#l00017">enumerators.h:17</a></div></div>
<div class="ttc" id="class_node_html_a9305e6376add78eafd94f198df0ee745"><div class="ttname"><a href="class_node.html#a9305e6376add78eafd94f198df0ee745">Node::setBoarderIndexX</a></div><div class="ttdeci">void setBoarderIndexX(int x)</div><div class="ttdef"><b>Definition:</b> <a href="node_8cpp_source.html#l00291">node.cpp:291</a></div></div>
<div class="ttc" id="classinitializer_html_ae6d34d311f884ceb489b3043a011864c"><div class="ttname"><a href="classinitializer.html#ae6d34d311f884ceb489b3043a011864c">initializer::initializeRag</a></div><div class="ttdeci">static void initializeRag(RAG &amp;rag, std::vector&lt; Node * &gt; &amp;selectedNodeSet)</div><div class="ttdef"><b>Definition:</b> <a href="initializer_8cpp_source.html#l00235">initializer.cpp:235</a></div></div>
<div class="ttc" id="enumerators_8h_html_af271aa044205af3808f72dbfb401bfdaa181e4b80585669687eae4cb4a527397e"><div class="ttname"><a href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa181e4b80585669687eae4cb4a527397e">S16I</a></div><div class="ttdef"><b>Definition:</b> <a href="enumerators_8h_source.html#l00017">enumerators.h:17</a></div></div>
<div class="ttc" id="classcompound_model_html_aa449c821f249e177001ce13d25485c99"><div class="ttname"><a href="classcompound_model.html#aa449c821f249e177001ce13d25485c99">compoundModel::areaWeighted</a></div><div class="ttdeci">static bool areaWeighted</div><div class="ttdef"><b>Definition:</b> <a href="compoundmodel_8h_source.html#l00073">compoundmodel.h:73</a></div></div>
<div class="ttc" id="classimage_html_a16c139a7a2ab7bb2c412f97d5abdcacd"><div class="ttname"><a href="classimage.html#a16c139a7a2ab7bb2c412f97d5abdcacd">image::setGlobalSettings</a></div><div class="ttdeci">void setGlobalSettings(int imageWidth, int imageHeight, int startPointX, int startPointY, int nBlocksX, int nBlocksY, bool ifDeleteNoise, double nStdLeft, double nStdRight, bool ifUseMinimumToMerge, int floor, int nbins, bool areaWeighted, double areaExponent, bool useStdCut, bool ifAddProbabilityModel, double probabilityModelWeight, int nClasses, std::vector&lt; double &gt; lamda, bool ifPaintRandomColor)</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l01242">image.cpp:1242</a></div></div>
<div class="ttc" id="classimage_html_a2de1707f5743afdd5c9684aa7a071b3f"><div class="ttname"><a href="classimage.html#a2de1707f5743afdd5c9684aa7a071b3f">image::fileNameImage</a></div><div class="ttdeci">std::string fileNameImage</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00089">image.h:89</a></div></div>
<div class="ttc" id="classio_html_a4cca3fdf98e917cac1b3e776c7634aec"><div class="ttname"><a href="classio.html#a4cca3fdf98e917cac1b3e776c7634aec">io::writeBoarderNodeToCSV</a></div><div class="ttdeci">static void writeBoarderNodeToCSV(Node *node, int label, ofstream &amp;fout, bool ifAddProbabilityModel)</div><div class="ttdef"><b>Definition:</b> <a href="io_8cpp_source.html#l00346">io.cpp:346</a></div></div>
<div class="ttc" id="classimage_html_adf6b8c126649c9a40387f12b5f5f07d5"><div class="ttname"><a href="classimage.html#adf6b8c126649c9a40387f12b5f5f07d5">image::ProcessBoundaryY</a></div><div class="ttdeci">void ProcessBoundaryY()</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00139">image.cpp:139</a></div></div>
<div class="ttc" id="classio_html_aaa642111086b3ec2afee826a767d03ad"><div class="ttname"><a href="classio.html#aaa642111086b3ec2afee826a767d03ad">io::writeNodeToDisk</a></div><div class="ttdeci">static void writeNodeToDisk(Node *node, int color[], GDALDataset *poDataset, int globalStartX, int globalStartY)</div><div class="ttdef"><b>Definition:</b> <a href="io_8cpp_source.html#l00259">io.cpp:259</a></div></div>
<div class="ttc" id="classcompound_model_html_a5cc93a5c3cd30c39cde1d8c6d8c70cd4"><div class="ttname"><a href="classcompound_model.html#a5cc93a5c3cd30c39cde1d8c6d8c70cd4">compoundModel::probabilityModelWeight</a></div><div class="ttdeci">static double probabilityModelWeight</div><div class="ttdef"><b>Definition:</b> <a href="compoundmodel_8h_source.html#l00076">compoundmodel.h:76</a></div></div>
<div class="ttc" id="class_node_html_adaaa531eae8cc809934f80b09ad8224e"><div class="ttname"><a href="class_node.html#adaaa531eae8cc809934f80b09ad8224e">Node::releaseTree</a></div><div class="ttdeci">void releaseTree()</div><div class="ttdef"><b>Definition:</b> <a href="node_8cpp_source.html#l00224">node.cpp:224</a></div></div>
<div class="ttc" id="classimage_html_aa21fc5a07af7528869425e750090b3b8"><div class="ttname"><a href="classimage.html#aa21fc5a07af7528869425e750090b3b8">image::mergeBlockY</a></div><div class="ttdeci">void mergeBlockY(const std::vector&lt; WorkingBoundary &gt; &amp;workingBoundaries, const std::vector&lt; int &gt; &amp;blockPosition1, const std::vector&lt; int &gt; &amp;blockPosition2)</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00363">image.cpp:363</a></div></div>
<div class="ttc" id="classimage_html_a4689c56b85c46d48ea52f0c9fa13891e"><div class="ttname"><a href="classimage.html#a4689c56b85c46d48ea52f0c9fa13891e">image::processing</a></div><div class="ttdeci">void processing()</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00021">image.cpp:21</a></div></div>
<div class="ttc" id="classimage_html_aa50311604615c5027bee9b24cfab49a8"><div class="ttname"><a href="classimage.html#aa50311604615c5027bee9b24cfab49a8">image::createEmptyCSV</a></div><div class="ttdeci">void createEmptyCSV(std::string fileName)</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l01489">image.cpp:1489</a></div></div>
<div class="ttc" id="classcompound_model_html_a3d76a3d82271411610ef987b8e9c7d72"><div class="ttname"><a href="classcompound_model.html#a3d76a3d82271411610ef987b8e9c7d72">compoundModel::areaExponent</a></div><div class="ttdeci">static double areaExponent</div><div class="ttdef"><b>Definition:</b> <a href="compoundmodel_8h_source.html#l00072">compoundmodel.h:72</a></div></div>
<div class="ttc" id="classimage_html_a05e6294bd8fc01bac57478de38e5a92d"><div class="ttname"><a href="classimage.html#a05e6294bd8fc01bac57478de38e5a92d">image::ComputeCircle</a></div><div class="ttdeci">int ComputeCircle(int totalTiles)</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00264">image.cpp:264</a></div></div>
<div class="ttc" id="class_node_html_a2bfcbd3b82b596744f81432f1824d522"><div class="ttname"><a href="class_node.html#a2bfcbd3b82b596744f81432f1824d522">Node::setPosition</a></div><div class="ttdeci">void setPosition(Point p)</div><div class="ttdef"><b>Definition:</b> <a href="node_8cpp_source.html#l00074">node.cpp:74</a></div></div>
<div class="ttc" id="enumerators_8h_html_af271aa044205af3808f72dbfb401bfdaa234e6937916f66a485971765c6bb5a8b"><div class="ttname"><a href="enumerators_8h.html#af271aa044205af3808f72dbfb401bfdaa234e6937916f66a485971765c6bb5a8b">U32I</a></div><div class="ttdef"><b>Definition:</b> <a href="enumerators_8h_source.html#l00017">enumerators.h:17</a></div></div>
<div class="ttc" id="class_node_html_a8a60e0e373f3acf5a26036a0b40312a1"><div class="ttname"><a href="class_node.html#a8a60e0e373f3acf5a26036a0b40312a1">Node::setModel</a></div><div class="ttdeci">void setModel(regionModel *m)</div><div class="ttdef"><b>Definition:</b> <a href="node_8cpp_source.html#l00158">node.cpp:158</a></div></div>
<div class="ttc" id="classimage_html_a8a46cfc72e8bbc9b85c431e9a4f6d755"><div class="ttname"><a href="classimage.html#a8a46cfc72e8bbc9b85c431e9a4f6d755">image::findImageFormat</a></div><div class="ttdeci">void findImageFormat()</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00184">image.cpp:184</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
